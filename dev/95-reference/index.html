<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference ¬∑ SpatialMultitaper.jl</title><meta name="title" content="Reference ¬∑ SpatialMultitaper.jl"/><meta property="og:title" content="Reference ¬∑ SpatialMultitaper.jl"/><meta property="twitter:title" content="Reference ¬∑ SpatialMultitaper.jl"/><meta name="description" content="Documentation for SpatialMultitaper.jl."/><meta property="og:description" content="Documentation for SpatialMultitaper.jl."/><meta property="twitter:description" content="Documentation for SpatialMultitaper.jl."/><meta property="og:url" content="https://JakeGrainger.github.io/SpatialMultitaper.jl/95-reference/"/><meta property="twitter:url" content="https://JakeGrainger.github.io/SpatialMultitaper.jl/95-reference/"/><link rel="canonical" href="https://JakeGrainger.github.io/SpatialMultitaper.jl/95-reference/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpatialMultitaper.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">SpatialMultitaper</a></li><li><a class="tocitem" href="../1-taper_creation/">Tapers</a></li><li><a class="tocitem" href="../2-multitapering/">Multitapering</a></li><li><a class="tocitem" href="../3-transformations/">Transformations</a></li><li><a class="tocitem" href="../4-spatial-functions/">Spatial functions</a></li><li><a class="tocitem" href="../90-contributing/">Contributing guidelines</a></li><li><a class="tocitem" href="../91-developer/">Developer documentation</a></li><li class="is-active"><a class="tocitem" href>Reference</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/main/docs/src/95-reference.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="reference"><a class="docs-heading-anchor" href="#reference">Reference</a><a id="reference-1"></a><a class="docs-heading-anchor-permalink" href="#reference" title="Permalink"></a></h1><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="#reference">Reference</a></li><li class="no-marker"><ul><li><a href="#Contents">Contents</a></li><li><a href="#Index">Index</a></li></ul></li></ul><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#SpatialMultitaper.SlepianSolver.LinearOperator"><code>SpatialMultitaper.SlepianSolver.LinearOperator</code></a></li><li><a href="#SpatialMultitaper.L2_inner_product_interpolated-Union{Tuple{D}, Tuple{T}, Tuple{AbstractArray{T, D}, AbstractArray{T, D}, CartesianGrid{M, C, N} where {M&lt;:ùîº, C&lt;:CoordRefSystems.Cartesian, N}}} where {T, D}"><code>SpatialMultitaper.L2_inner_product_interpolated</code></a></li><li><a href="#SpatialMultitaper.SlepianSolver.compute_eigenfunctions-Union{Tuple{D}, Tuple{AbstractArray{Bool, D}, AbstractArray{Bool, D}}, Tuple{AbstractArray{Bool, D}, AbstractArray{Bool, D}, Any}} where D"><code>SpatialMultitaper.SlepianSolver.compute_eigenfunctions</code></a></li><li><a href="#SpatialMultitaper.SlepianSolver.make_concentration_operator"><code>SpatialMultitaper.SlepianSolver.make_concentration_operator</code></a></li><li><a href="#SpatialMultitaper.box2sides-Tuple{Box}"><code>SpatialMultitaper.box2sides</code></a></li><li><a href="#SpatialMultitaper.centerpad-Tuple{Any, Any}"><code>SpatialMultitaper.centerpad</code></a></li><li><a href="#SpatialMultitaper.choose_freq_1d-Tuple{Any, Any}"><code>SpatialMultitaper.choose_freq_1d</code></a></li><li><a href="#SpatialMultitaper.choose_freq_res-Tuple{Any, Any}"><code>SpatialMultitaper.choose_freq_res</code></a></li><li><a href="#SpatialMultitaper.dft2spectralmatrix-Union{Tuple{NTuple{P, Array{T, N}}}, Tuple{N}, Tuple{T}, Tuple{P}} where {P, T, N}"><code>SpatialMultitaper.dft2spectralmatrix</code></a></li><li><a href="#SpatialMultitaper.dft2spectralmatrix-Tuple{Array}"><code>SpatialMultitaper.dft2spectralmatrix</code></a></li><li><a href="#SpatialMultitaper.downsample-Union{Tuple{T}, Tuple{D}, Tuple{AbstractArray{T, D}, Int64}} where {D, T}"><code>SpatialMultitaper.downsample</code></a></li><li><a href="#SpatialMultitaper.fft_anydomain-Union{Tuple{D}, Tuple{Array, Grid, NTuple{D, Int64}, NTuple{D, Number}}} where D"><code>SpatialMultitaper.fft_anydomain</code></a></li><li><a href="#SpatialMultitaper.freq_downsample_index-Tuple{Any, Any}"><code>SpatialMultitaper.freq_downsample_index</code></a></li><li><a href="#SpatialMultitaper.freq_downsample_startindex-Tuple{Any, Any}"><code>SpatialMultitaper.freq_downsample_startindex</code></a></li><li><a href="#SpatialMultitaper.grid2side-Tuple{CartesianGrid{M, C, N} where {M&lt;:ùîº, C&lt;:CoordRefSystems.Cartesian, N}}"><code>SpatialMultitaper.grid2side</code></a></li><li><a href="#SpatialMultitaper.interpolated_taper_family-Tuple{Vector{&lt;:AbstractArray}, CartesianGrid{M, C, N} where {M&lt;:ùîº, C&lt;:CoordRefSystems.Cartesian, N}}"><code>SpatialMultitaper.interpolated_taper_family</code></a></li><li><a href="#SpatialMultitaper.make_tapers-Tuple{Any}"><code>SpatialMultitaper.make_tapers</code></a></li><li><a href="#SpatialMultitaper.multitaper_estimate-Tuple{Union{GeoTable, PointSet}, Any}"><code>SpatialMultitaper.multitaper_estimate</code></a></li><li><a href="#SpatialMultitaper.newweight-Tuple{AbstractArray, Nothing}"><code>SpatialMultitaper.newweight</code></a></li><li><a href="#SpatialMultitaper.nufft1d1_anydomain-NTuple{7, Any}"><code>SpatialMultitaper.nufft1d1_anydomain</code></a></li><li><a href="#SpatialMultitaper.nufft1d1_anydomain!-NTuple{6, Any}"><code>SpatialMultitaper.nufft1d1_anydomain!</code></a></li><li><a href="#SpatialMultitaper.nufft1d1_anydomain_precomp-NTuple{5, Any}"><code>SpatialMultitaper.nufft1d1_anydomain_precomp</code></a></li><li><a href="#SpatialMultitaper.nufft2d1_anydomain-NTuple{8, Any}"><code>SpatialMultitaper.nufft2d1_anydomain</code></a></li><li><a href="#SpatialMultitaper.nufft2d1_anydomain!-NTuple{6, Any}"><code>SpatialMultitaper.nufft2d1_anydomain!</code></a></li><li><a href="#SpatialMultitaper.nufft2d1_anydomain_precomp-NTuple{6, Any}"><code>SpatialMultitaper.nufft2d1_anydomain_precomp</code></a></li><li><a href="#SpatialMultitaper.nufft3d1_anydomain-NTuple{9, Any}"><code>SpatialMultitaper.nufft3d1_anydomain</code></a></li><li><a href="#SpatialMultitaper.nufft3d1_anydomain!-NTuple{6, Any}"><code>SpatialMultitaper.nufft3d1_anydomain!</code></a></li><li><a href="#SpatialMultitaper.nufft3d1_anydomain_precomp-NTuple{7, Any}"><code>SpatialMultitaper.nufft3d1_anydomain_precomp</code></a></li><li><a href="#SpatialMultitaper.nufft_anydomain-Tuple{Any, Any, Any, PointSet, Any, Any, Any}"><code>SpatialMultitaper.nufft_anydomain</code></a></li><li><a href="#SpatialMultitaper.optimaltapers-Tuple{Union{Domain, Geometry}, CartesianGrid{M, C, N} where {M&lt;:ùîº, C&lt;:CoordRefSystems.Cartesian, N}}"><code>SpatialMultitaper.optimaltapers</code></a></li><li><a href="#SpatialMultitaper.pad-Union{Tuple{D}, Tuple{T}, Tuple{AbstractArray{T, D}, Int64}} where {T, D}"><code>SpatialMultitaper.pad</code></a></li><li><a href="#SpatialMultitaper.partial_K-Tuple{Any, Any}"><code>SpatialMultitaper.partial_K</code></a></li><li><a href="#SpatialMultitaper.partial_spectra-Tuple{AbstractMatrix}"><code>SpatialMultitaper.partial_spectra</code></a></li><li><a href="#SpatialMultitaper.points2coords-Tuple{PointSet}"><code>SpatialMultitaper.points2coords</code></a></li><li><a href="#SpatialMultitaper.reprocess-Union{Tuple{T}, Tuple{D}, Tuple{AbstractArray{T, D}, Any, Any}} where {D, T}"><code>SpatialMultitaper.reprocess</code></a></li><li><a href="#SpatialMultitaper.rescale_points-NTuple{4, Any}"><code>SpatialMultitaper.rescale_points</code></a></li><li><a href="#SpatialMultitaper.sdf2K-Union{Tuple{T}, Tuple{D}, Tuple{Any, AbstractArray{T, D}, Any, Nothing}} where {D, T}"><code>SpatialMultitaper.sdf2K</code></a></li><li><a href="#SpatialMultitaper.side2grid-Tuple{NTuple{N, T} where {N, T}}"><code>SpatialMultitaper.side2grid</code></a></li><li><a href="#SpatialMultitaper.sin_taper_family-Tuple{Any, Box}"><code>SpatialMultitaper.sin_taper_family</code></a></li><li><a href="#SpatialMultitaper.tapered_dft-Tuple{AbstractVector{&lt;:Union{GeoTable, PointSet}}, Any, Any, Any, Any, AbstractVector{&lt;:SpatialMultitaper.MeanEstimationMethod}}"><code>SpatialMultitaper.tapered_dft</code></a></li><li><a href="#SpatialMultitaper.tapered_dft-Union{Tuple{P}, Tuple{NTuple{P, Union{GeoTable, PointSet}}, Any, Any, Any, Any, NTuple{P, SpatialMultitaper.MeanEstimationMethod}}} where P"><code>SpatialMultitaper.tapered_dft</code></a></li><li><a href="#SpatialMultitaper.unwrap_fft_output-Union{Tuple{D}, Tuple{AbstractArray, NTuple{D, Int64}}} where D"><code>SpatialMultitaper.unwrap_fft_output</code></a></li><li><a href="#SpatialMultitaper.unwrap_index-Tuple{Any, Any}"><code>SpatialMultitaper.unwrap_index</code></a></li><li><a href="#SpatialMultitaper.upsample-Tuple{AbstractArray, CartesianGrid{M, C, N} where {M&lt;:ùîº, C&lt;:CoordRefSystems.Cartesian, N}, Nothing}"><code>SpatialMultitaper.upsample</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.L2_inner_product_interpolated-Union{Tuple{D}, Tuple{T}, Tuple{AbstractArray{T, D}, AbstractArray{T, D}, CartesianGrid{M, C, N} where {M&lt;:ùîº, C&lt;:CoordRefSystems.Cartesian, N}}} where {T, D}" href="#SpatialMultitaper.L2_inner_product_interpolated-Union{Tuple{D}, Tuple{T}, Tuple{AbstractArray{T, D}, AbstractArray{T, D}, CartesianGrid{M, C, N} where {M&lt;:ùîº, C&lt;:CoordRefSystems.Cartesian, N}}} where {T, D}"><code>SpatialMultitaper.L2_inner_product_interpolated</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">interp_ip_2(h::AbstractArray{T,D}, g::AbstractArray{T,D}, grid::CartesianGrid) where {T,D}</code></pre><p>The L‚ÇÇ inner product of interpolated sequences <code>g</code> and <code>h</code> recorded on grid <code>grid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/tapers.jl#L58-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.box2sides-Tuple{Box}" href="#SpatialMultitaper.box2sides-Tuple{Box}"><code>SpatialMultitaper.box2sides</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">box2sides(box::Box)</code></pre><p>Converts a box to a tuple of tuples, whose <code>j&#39;th entry is the</code>j`th coordinate of the minimum and maximum of the box.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/utils.jl#L25-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.centerpad-Tuple{Any, Any}" href="#SpatialMultitaper.centerpad-Tuple{Any, Any}"><code>SpatialMultitaper.centerpad</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">centerpad(x, i)</code></pre><p>Pads <code>x</code> with zeros on all sides by <code>i</code> elements. For example, if <code>x = 1:2</code> and <code>i = 1</code>, then the output is <code>[0, 1, 2, 0]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/utils.jl#L79-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.choose_freq_1d-Tuple{Any, Any}" href="#SpatialMultitaper.choose_freq_1d-Tuple{Any, Any}"><code>SpatialMultitaper.choose_freq_1d</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">choose_freq_1d(nfreq, fmax)</code></pre><p>Returns the frequencies for our fft interfaces, with <code>nfreq</code> frequencies, and <code>fmax</code> as the fmax frequency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/frequencies.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.choose_freq_res-Tuple{Any, Any}" href="#SpatialMultitaper.choose_freq_res-Tuple{Any, Any}"><code>SpatialMultitaper.choose_freq_res</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">choose_freq_res(n, nfreq; maxitr=100)</code></pre><p>Find the smallest integer <code>oversample</code> such that <code>nfreq*oversample ‚â• n</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/fft_interface.jl#L81-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.dft2spectralmatrix-Tuple{Array}" href="#SpatialMultitaper.dft2spectralmatrix-Tuple{Array}"><code>SpatialMultitaper.dft2spectralmatrix</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dft2spectralmatrix(J_n::Array)</code></pre><p>Computes the spectral matrix from the DFTs, assuming that the DFTs are stored as one large array which is P x M x n<em>1 x ... x n</em>D.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/spectral_estimate.jl#L68-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.dft2spectralmatrix-Union{Tuple{NTuple{P, Array{T, N}}}, Tuple{N}, Tuple{T}, Tuple{P}} where {P, T, N}" href="#SpatialMultitaper.dft2spectralmatrix-Union{Tuple{NTuple{P, Array{T, N}}}, Tuple{N}, Tuple{T}, Tuple{P}} where {P, T, N}"><code>SpatialMultitaper.dft2spectralmatrix</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dft2spectralmatrix(J_n::NTuple{P, Array{T, N}}) where {P, T, N}</code></pre><p>Computes the spectral matrix from the DFTs, assuming that the DFTs are stored as a tuple of P arrays of size n<em>1 x ... x n</em>D x M.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/spectral_estimate.jl#L76-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.downsample-Union{Tuple{T}, Tuple{D}, Tuple{AbstractArray{T, D}, Int64}} where {D, T}" href="#SpatialMultitaper.downsample-Union{Tuple{T}, Tuple{D}, Tuple{AbstractArray{T, D}, Int64}} where {D, T}"><code>SpatialMultitaper.downsample</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">downsample(x::AbstractArray{T,D}, spacing) where {D,T}</code></pre><p>Down sample an <code>AbstractArray</code>. Specify <code>spacing</code> as an <code>Int</code>, for same spacing in all dims. Specify <code>spacing</code> as an <code>NTuple{D,Int}</code> for different spacing. Specify <code>spacing=nothing</code> to just return <code>x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/utils.jl#L91-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.fft_anydomain-Union{Tuple{D}, Tuple{Array, Grid, NTuple{D, Int64}, NTuple{D, Number}}} where D" href="#SpatialMultitaper.fft_anydomain-Union{Tuple{D}, Tuple{Array, Grid, NTuple{D, Int64}, NTuple{D, Number}}} where D"><code>SpatialMultitaper.fft_anydomain</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fft_anydomain(x::Array, grid::Grid, nfreq, fmax; kwargs...)</code></pre><p>Apply an fft to data stored in <code>x</code> given that <code>x</code> is recorded on a grid <code>grid</code>. The output is at frequencies determined by <code>nfreq</code> and <code>fmax</code>. <code>x</code> can have more dimensions than <code>grid</code> but the first dimensions must be the same as the grid (up to the size of the grid).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/fft_interface.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.freq_downsample_index-Tuple{Any, Any}" href="#SpatialMultitaper.freq_downsample_index-Tuple{Any, Any}"><code>SpatialMultitaper.freq_downsample_index</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">freq_downsample_index(nfreq, oversample)</code></pre><p>Returns the indices required to downsample the oversampled frequencies with a given oversampling. This assumes that the frequencies are fftshifted.</p><p><strong>Arguments</strong></p><ul><li><code>nfreq::Int</code>: The number of frequencies for the desired output.</li><li><code>oversample::Int</code>: The oversampling factor used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/frequencies.jl#L23-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.freq_downsample_startindex-Tuple{Any, Any}" href="#SpatialMultitaper.freq_downsample_startindex-Tuple{Any, Any}"><code>SpatialMultitaper.freq_downsample_startindex</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">freq_downsample_startindex(nfreq,oversample)</code></pre><p>Returns the starting index for the oversampled frequencies to downsample.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/frequencies.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.grid2side-Tuple{CartesianGrid{M, C, N} where {M&lt;:ùîº, C&lt;:CoordRefSystems.Cartesian, N}}" href="#SpatialMultitaper.grid2side-Tuple{CartesianGrid{M, C, N} where {M&lt;:ùîº, C&lt;:CoordRefSystems.Cartesian, N}}"><code>SpatialMultitaper.grid2side</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">grid2side(g::CartesianGrid)</code></pre><p>Converts a grid to a tuple of the location of the centers for each side.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/utils.jl#L37-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.interpolated_taper_family-Tuple{Vector{&lt;:AbstractArray}, CartesianGrid{M, C, N} where {M&lt;:ùîº, C&lt;:CoordRefSystems.Cartesian, N}}" href="#SpatialMultitaper.interpolated_taper_family-Tuple{Vector{&lt;:AbstractArray}, CartesianGrid{M, C, N} where {M&lt;:ùîº, C&lt;:CoordRefSystems.Cartesian, N}}"><code>SpatialMultitaper.interpolated_taper_family</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">interpolated_taper_family(raw_tapers, grid; freq_res=size(grid))</code></pre><p>Constructs a multitaper object from multiple taper discrete impulse responses on a grid. </p><p><strong>Arguments</strong></p><ul><li><code>raw_tapers</code>: A <code>Vector</code> of <code>AbstractArray</code>s containing the taper impulse response.</li><li><code>grid</code>: The grid corresponding to the tapers.</li><li><code>freq_res</code>: Optional named argument specifying the upsampling for computing the transfer function.</li></ul><p><strong>Frequency sampling</strong></p><ul><li>The frequency grid on which the transfer function will be sampled has:</li></ul><pre><code class="nohighlight hljs">- length `freq_res`.
- interval `unitless_spacing(grid)/freq_res`.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/tapers.jl#L142-L156">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.make_tapers-Tuple{Any}" href="#SpatialMultitaper.make_tapers-Tuple{Any}"><code>SpatialMultitaper.make_tapers</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">make_tapers(region; bandwidth, threshold = 0.99, space_res = 100, freq_res = 500, freq_generate_res = 500, ntapers_max = 30)</code></pre><p>A function to create tapers for a given region.</p><p><strong>Arguments</strong></p><ul><li><code>region</code>: The region to create the tapers on.</li><li><code>bandwidth</code>: The bandwidth of the tapers</li><li><code>threshold</code>: The threshold for the number of tapers to use.</li><li><code>space_res</code>: The resolution of the grid to create the tapers on.</li><li><code>freq_res</code>: The resolution of the frequency grid to compute the transfer function on.</li><li><code>freq_generate_res</code>: The resolution of the frequency grid to generate the tapers on.</li><li><code>ntapers_max</code>: The maximum number of tapers to generate.</li></ul><p>As a rough rule of thumb, setting the bandwidth to an integer multiple (say <code>x</code>) of a side length of the bounding square of a region will  produce <code>x^d</code> tapers (note this is a very crude approximation, but you will find out how many good tapers you can make when you create them).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/tapers.jl#L237-L253">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.multitaper_estimate-Tuple{Union{GeoTable, PointSet}, Any}" href="#SpatialMultitaper.multitaper_estimate-Tuple{Union{GeoTable, PointSet}, Any}"><code>SpatialMultitaper.multitaper_estimate</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">multitaper_estimate(data, region; nfreq, fmax, tapers, mean_method = DefaultMean())</code></pre><p>Computes the multitaper spectral estimate from a tapered dft.</p><p><strong>Arguments:</strong></p><ul><li><code>data</code>: The data to estimate the spectrum from.</li><li><code>region</code>: The region to estimate the spectrum from.</li><li><code>nfreq::NTuple{D,Int}</code>: The number of frequencies in each dimension.</li><li><code>fmax::NTuple{D,Real}</code>: The maximum frequency in each dimension.</li><li><code>tapers</code>: A tuple of taper functions.</li><li><code>mean_method</code>: The method to estimate the mean. Default is <code>DefaultMean</code>, but can use <code>KnownMean(x)</code> to specify this if known.</li></ul><p><strong>Output:</strong></p><p>The output is a <code>SpectralEstimate</code> object, with a <code>freq</code> and <code>power</code> field. Say <code>nfreq = (n_1,...,n_D)</code>, then <code>freq</code> is a <code>D</code> dimensional <code>NTuple</code> of arrays of frequencies in each dimension. Power can be in the following forms:</p><ul><li>If <code>data</code> is a single process, then <code>power</code> is a <code>n_1 x ... x n_D</code> array.</li><li>If <code>data</code> has <code>P</code> processes and is passed as an <code>NTuple</code>, then <code>power</code> is an <code>n_1 x ... x n_D</code> array of <code>SMatrix{P,P,T,P*P}</code>.</li><li>If <code>data</code> is a vector of <code>P</code> processes, then <code>power</code> is a <code>P x P x n_1 x ... x n_D</code> array.</li></ul><p>In any case, indexing into a <code>SpectralEstimate</code> will provide a <code>SpectralEstimate</code> object with the same <code>freq</code> and a subset of the <code>power</code> array corresponding to the processes in the chosen index.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/spectral_estimate.jl#L12-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.newweight-Tuple{AbstractArray, Nothing}" href="#SpatialMultitaper.newweight-Tuple{AbstractArray, Nothing}"><code>SpatialMultitaper.newweight</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">newweight(h, freq_downsampling)</code></pre><p>Necessary because eigs gives normalised vector under the downsampling.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/general_tapers.jl#L73-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.nufft1d1_anydomain!-NTuple{6, Any}" href="#SpatialMultitaper.nufft1d1_anydomain!-NTuple{6, Any}"><code>SpatialMultitaper.nufft1d1_anydomain!</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nufft1d1_anydomain!(output_storage, input_data, nfreq, fmax, iflag, eps; kwargs...)</code></pre><p>In place version of <code>nufft1d1_anydomain</code>. Use <code>nufft1d1_anydomain_precomp</code> to precompute the input data and memory required.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/nufft_interface.jl#L73-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.nufft1d1_anydomain-NTuple{7, Any}" href="#SpatialMultitaper.nufft1d1_anydomain-NTuple{7, Any}"><code>SpatialMultitaper.nufft1d1_anydomain</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nufft1d1_anydomain(interval, nfreq, fmax, xj, cj, iflag, eps; kwargs...)</code></pre><p>Computes the approximate dft of a 1d function using the nufft algorithm, with points in any interval, at frequencies defined by <code>fmax</code> and <code>nfreq</code>. <code>xj</code> are the points coordinates and <code>cj</code> are the function values. Set <code>iflag&lt;0</code> for -i in exponent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/nufft_interface.jl#L53-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.nufft1d1_anydomain_precomp-NTuple{5, Any}" href="#SpatialMultitaper.nufft1d1_anydomain_precomp-NTuple{5, Any}"><code>SpatialMultitaper.nufft1d1_anydomain_precomp</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nufft1d1_anydomain_precomp(interval, nfreq, fmax, xj, cj)</code></pre><p>Precomputes the input data and memory required for <code>nufft1d1_anydomain!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/nufft_interface.jl#L99-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.nufft2d1_anydomain!-NTuple{6, Any}" href="#SpatialMultitaper.nufft2d1_anydomain!-NTuple{6, Any}"><code>SpatialMultitaper.nufft2d1_anydomain!</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nufft2d1_anydomain!(output_storage, input_data, nfreq, fmax, iflag, eps; kwargs...)</code></pre><p>In place version of <code>nufft2d1_anydomain</code>. Use <code>nufft2d1_anydomain_precomp</code> to precompute the input data and memory required.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/nufft_interface.jl#L147-L151">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.nufft2d1_anydomain-NTuple{8, Any}" href="#SpatialMultitaper.nufft2d1_anydomain-NTuple{8, Any}"><code>SpatialMultitaper.nufft2d1_anydomain</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nufft2d1_anydomain(box, nfreq, fmax, xj, yj, cj, iflag, eps; kwargs...)</code></pre><p>Computes the approximate dft of a 2d function using the nufft algorithm, with points in any box, at frequencies defined by <code>fmax</code> and <code>nfreq</code>. <code>box</code> here should be a tuple of intervals, one for each dimension. Similarly for <code>fmax</code> and <code>nfreq</code>. <code>xj</code>, <code>yj</code> are the points coordinates and <code>cj</code> are the function values. Set <code>iflag&lt;0</code> for -i in exponent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/nufft_interface.jl#L125-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.nufft2d1_anydomain_precomp-NTuple{6, Any}" href="#SpatialMultitaper.nufft2d1_anydomain_precomp-NTuple{6, Any}"><code>SpatialMultitaper.nufft2d1_anydomain_precomp</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nufft2d1_anydomain_precomp(box, nfreq, fmax, xj, yj, cj)</code></pre><p>Precomputes the input data and memory required for <code>nufft2d1_anydomain!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/nufft_interface.jl#L185-L189">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.nufft3d1_anydomain!-NTuple{6, Any}" href="#SpatialMultitaper.nufft3d1_anydomain!-NTuple{6, Any}"><code>SpatialMultitaper.nufft3d1_anydomain!</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nufft3d1_anydomain!(output_storage, input_data, nfreq, fmax, iflag, eps; kwargs...)</code></pre><p>In place version of <code>nufft3d1_anydomain</code>. Use <code>nufft3d1_anydomain_precomp</code> to precompute the input data and memory required.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/nufft_interface.jl#L238-L242">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.nufft3d1_anydomain-NTuple{9, Any}" href="#SpatialMultitaper.nufft3d1_anydomain-NTuple{9, Any}"><code>SpatialMultitaper.nufft3d1_anydomain</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nufft3d1_anydomain(cube, nfreq, fmax, xj, yj, zj, cj, iflag, eps; kwargs...)</code></pre><p>Computes the approximate dft of a 3d function using the nufft algorithm, with points in any cube, at frequencies defined by <code>fmax</code> and <code>nfreq</code>. <code>cube</code> here should be a tuple of intervals, one for each dimension. Similarly for <code>fmax</code> and <code>nfreq</code>. <code>xj</code>, <code>yj</code>, <code>zj</code> are the points coordinates and <code>cj</code> are the function values. Set <code>iflag&lt;0</code> for -i in exponent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/nufft_interface.jl#L222-L230">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.nufft3d1_anydomain_precomp-NTuple{7, Any}" href="#SpatialMultitaper.nufft3d1_anydomain_precomp-NTuple{7, Any}"><code>SpatialMultitaper.nufft3d1_anydomain_precomp</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nufft3d1_anydomain_precomp(cube, nfreq, fmax, xj, yj, zj, cj)</code></pre><p>Precomputes the input data and memory required for <code>nufft3d1_anydomain!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/nufft_interface.jl#L300-L304">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.nufft_anydomain-Tuple{Any, Any, Any, PointSet, Any, Any, Any}" href="#SpatialMultitaper.nufft_anydomain-Tuple{Any, Any, Any, PointSet, Any, Any, Any}"><code>SpatialMultitaper.nufft_anydomain</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nufft_anydomain(region, nfreq, fmax, points::PointSet, c, iflag, eps; kwargs...)</code></pre><p>Computes the approximate dft of a function using the nufft algorithm, with points in any region, at frequencies defined by <code>fmax</code> and <code>nfreq</code>. Currently only 1d, 2d and 3d are supported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/nufft_interface.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.optimaltapers-Tuple{Union{Domain, Geometry}, CartesianGrid{M, C, N} where {M&lt;:ùîº, C&lt;:CoordRefSystems.Cartesian, N}}" href="#SpatialMultitaper.optimaltapers-Tuple{Union{Domain, Geometry}, CartesianGrid{M, C, N} where {M&lt;:ùîº, C&lt;:CoordRefSystems.Cartesian, N}}"><code>SpatialMultitaper.optimaltapers</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">optimaltapers(region::Meshes.GeometryOrDomain, grid::CartesianGrid; freq_region::Meshes.GeometryOrDomain, ntapers::Int, freq_res, freq_downsample=nothing, real_tapers=true, tol=0.0)</code></pre><p>Function to compute the optimal tapers for a given <code>region</code>, <code>grid</code> and region in frequency.</p><p><strong>Arguments:</strong></p><ul><li><code>region</code>: The spatial observation region. Should be of type <code>Geometry</code> or <code>Domain</code>.</li><li><code>grid</code>: A <code>CartesianGrid</code> containing the region on which we wish to have a taper.</li><li><code>freq_region</code>: The region in frequency we want to concentrate the taper on. Typically a <code>Ball</code> centered at zero.</li><li><code>ntapers</code>: The number of desired tapers.</li><li><code>freq_res</code>: The oversampling to be used in frequency.</li><li><code>real_tapers</code>: Optional argument to decided if real or complex tapers should be provided. Default is <code>true</code> which provides real tapers.</li><li><code>tol</code>: Optional argument passed to the <code>eigs</code> function of <code>Arpack</code>. You likely need to play with this.</li></ul><p><strong>Note about errors:</strong></p><p>If you have an error, it is likely a convergence problem. Try setting a larger value for <code>tol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/general_tapers.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.pad-Union{Tuple{D}, Tuple{T}, Tuple{AbstractArray{T, D}, Int64}} where {T, D}" href="#SpatialMultitaper.pad-Union{Tuple{D}, Tuple{T}, Tuple{AbstractArray{T, D}, Int64}} where {T, D}"><code>SpatialMultitaper.pad</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pad(x::AbstractArray{T,D}, n::NTuple{D,Int}) where {T,D}
pad(x::AbstractArray{T,D}, n::Int) where {T,D}</code></pre><p>Pad <code>x</code> with zeros to size <code>n</code>.  Note that <code>size(x) ‚â§ n</code> must hold, and the new array is of size <code>n</code> not <code>size(x).+n</code>. If an integer is provided for <code>n</code>, it is interpreted as <code>ntuple(d-&gt;n, Val{D}())</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/utils.jl#L63-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.partial_K-Tuple{Any, Any}" href="#SpatialMultitaper.partial_K-Tuple{Any, Any}"><code>SpatialMultitaper.partial_K</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">partial_K(data, region; radii, nfreq, fmax, tapers, indices, upscalefactor)</code></pre><p>Computes the partial K function from the <code>data</code> at radii <code>radii</code>. Default is to compute this for all pairs of indices conditional on any index not included. Alternatively, pass a vector of indices. If this is a vector of <code>Tuple{Int,Int}</code>, then this is computed partial on every other index. If this is a <code>Tuple{Int,Int,AbstractVector{Int},AbstractVector{Int}}</code>, then this is computed partial on the specified indices, i.e. The residual of <code>index[1]</code> partial <code>index[3]</code> with <code>index[2]</code> partial <code>index[4]</code>. Setting <code>upscalefactor</code> to <code>nothing</code> does no upscaling. Otherwise, set to an <code>Int</code> or an <code>NTuple{D,Int}</code> to upscale the spectra for the computation of the partial K.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/K_function.jl#L33-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.partial_spectra-Tuple{AbstractMatrix}" href="#SpatialMultitaper.partial_spectra-Tuple{AbstractMatrix}"><code>SpatialMultitaper.partial_spectra</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">partial_spectra(x::Matrix)</code></pre><p>If only a matrix <code>x</code> is passed, computes the partial spectra for all indices.  The diagonal elements are the spectra of residuals given all other processes The i j th element (for i ‚â† j) is the partial coherence between the ith and jth process given all other processes not including i and j.</p><pre><code class="nohighlight hljs">partial_spectra(x::Matrix, i1::Int, i2::Int, c1, c2)</code></pre><p>If specific indices are requested, computes the partial spectra for the i1th index conditioned on the indices in c1 vs the i2th index conditioned on the indices in c2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/transforms/partial/partial_spectra.jl#L13-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.points2coords-Tuple{PointSet}" href="#SpatialMultitaper.points2coords-Tuple{PointSet}"><code>SpatialMultitaper.points2coords</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">points2coords(points::PointSet)</code></pre><p>Converts PointSet to a tuple of view of reinterpreted arrays, whose <code>j&#39;th entry is the</code>j`th coordinate of each of the points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/utils.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.reprocess-Union{Tuple{T}, Tuple{D}, Tuple{AbstractArray{T, D}, Any, Any}} where {D, T}" href="#SpatialMultitaper.reprocess-Union{Tuple{T}, Tuple{D}, Tuple{AbstractArray{T, D}, Any, Any}} where {D, T}"><code>SpatialMultitaper.reprocess</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reprocess(h_large, grid, freq_downsample)</code></pre><p>Undoes the downsampling and padding.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/general_tapers.jl#L60-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.rescale_points-NTuple{4, Any}" href="#SpatialMultitaper.rescale_points-NTuple{4, Any}"><code>SpatialMultitaper.rescale_points</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rescale_points(x, nfreq, fmax, interval; max_oversample = 100)</code></pre><p>Rescales points to be in the interval [-œÄ, œÄ] and returns the oversampling factor. Oversampling factor is the smallest integer such that the interval is rescaled to fit in [-œÄ, œÄ], and the corresponding fmax frequency is a multiple of <code>fmax</code>. Interval just needs to have <code>minimum</code> and <code>maximum</code> defined.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/nufft_interface.jl#L344-L351">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.sdf2K-Union{Tuple{T}, Tuple{D}, Tuple{Any, AbstractArray{T, D}, Any, Nothing}} where {D, T}" href="#SpatialMultitaper.sdf2K-Union{Tuple{T}, Tuple{D}, Tuple{Any, AbstractArray{T, D}, Any, Nothing}} where {D, T}"><code>SpatialMultitaper.sdf2K</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sdf2K(freq, spectra::AbstractArray{T,D}, r) where {D,T}</code></pre><p>Computes the K function from the spectral density function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/K_function.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.side2grid-Tuple{NTuple{N, T} where {N, T}}" href="#SpatialMultitaper.side2grid-Tuple{NTuple{N, T} where {N, T}}"><code>SpatialMultitaper.side2grid</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">side2grid(sides)</code></pre><p>inverse of grid2side</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/utils.jl#L49-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.sin_taper_family-Tuple{Any, Box}" href="#SpatialMultitaper.sin_taper_family-Tuple{Any, Box}"><code>SpatialMultitaper.sin_taper_family</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">make_sin_tapers(lbw, region::Box, gridsize)</code></pre><p>Construct the sin tapers for a given region and gridsize.</p><p><strong>Arguments:</strong></p><ul><li><code>ntapers</code>: The number of tapers.</li><li><code>region</code>: The region to construct the tapers on. Must be a box.</li></ul><p><strong>Background:</strong></p><p>The sin tapers on a unit interval are defined as:</p><p class="math-container">\[h_m(x) = \sqrt{2} * \sin(œÄxm)\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/tapers.jl#L185-L199">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.tapered_dft-Tuple{AbstractVector{&lt;:Union{GeoTable, PointSet}}, Any, Any, Any, Any, AbstractVector{&lt;:SpatialMultitaper.MeanEstimationMethod}}" href="#SpatialMultitaper.tapered_dft-Tuple{AbstractVector{&lt;:Union{GeoTable, PointSet}}, Any, Any, Any, Any, AbstractVector{&lt;:SpatialMultitaper.MeanEstimationMethod}}"><code>SpatialMultitaper.tapered_dft</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tapered_dft(data::AbstractVector{&lt;:Union{GeoTable,PointSet}}, tapers, nfreq, fmax, region, mean_method::AbstractVector{&lt;:MeanEstimationMethod})</code></pre><p>Compute the tapered discrete Fourier transform of a collection of data sets. If we have <code>n_1,...,n_D</code> frequencies, and M tapers and P processes, this returns an array of size <code>P x M x n_1 x ... x n_D</code>. Note that for small numbers of processes, it is more efficient to use the <code>NTuple</code> method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/tapered_dft.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.tapered_dft-Union{Tuple{P}, Tuple{NTuple{P, Union{GeoTable, PointSet}}, Any, Any, Any, Any, NTuple{P, SpatialMultitaper.MeanEstimationMethod}}} where P" href="#SpatialMultitaper.tapered_dft-Union{Tuple{P}, Tuple{NTuple{P, Union{GeoTable, PointSet}}, Any, Any, Any, Any, NTuple{P, SpatialMultitaper.MeanEstimationMethod}}} where P"><code>SpatialMultitaper.tapered_dft</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tapered_dft(data::NTuple{P,Union{GeoTable, PointSet}}, tapers, nfreq, fmax, region, mean_method::NTuple{P,MeanEstimationMethod}) where {P}</code></pre><p>Compute the tapered discrete Fourier transform of a collection of data sets. If we have n<em>1,...,n</em>D frequencies, and M tapers and P processes, this returns a <code>Tuple</code> of size <code>P</code>, whose entries are arrays of size <code>n_1 x ... x n_D x M</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/tapered_dft.jl#L24-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.unwrap_fft_output-Union{Tuple{D}, Tuple{AbstractArray, NTuple{D, Int64}}} where D" href="#SpatialMultitaper.unwrap_fft_output-Union{Tuple{D}, Tuple{AbstractArray, NTuple{D, Int64}}} where D"><code>SpatialMultitaper.unwrap_fft_output</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unwrap_fft_output(J::AbstractArray, fmaxrel::NTuple{D, Int}) where {D}</code></pre><p>Copies the result of the fft to give something which goes up to some multiple of the nyquist frequency (whilst keeping the number of output frequencies).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/fft_interface.jl#L97-L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.unwrap_index-Tuple{Any, Any}" href="#SpatialMultitaper.unwrap_index-Tuple{Any, Any}"><code>SpatialMultitaper.unwrap_index</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unwrap_index(n, a)</code></pre><p>The indices required to unwrap the fft output to go up to <code>n</code> with a given oversampling <code>a</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/dft_interface/fft_interface.jl#L122-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.upsample-Tuple{AbstractArray, CartesianGrid{M, C, N} where {M&lt;:ùîº, C&lt;:CoordRefSystems.Cartesian, N}, Nothing}" href="#SpatialMultitaper.upsample-Tuple{AbstractArray, CartesianGrid{M, C, N} where {M&lt;:ùîº, C&lt;:CoordRefSystems.Cartesian, N}, Nothing}"><code>SpatialMultitaper.upsample</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">upsample(x::AbstractArray, grid::CartesianGrid, freq_downsample)</code></pre><p>Upsamples an array using linear interpolation, checking the grid size against x. Note this is specific to downsample as used here, and shouldn&#39;t be used for general upsampling.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/utils.jl#L108-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.SlepianSolver.LinearOperator" href="#SpatialMultitaper.SlepianSolver.LinearOperator"><code>SpatialMultitaper.SlepianSolver.LinearOperator</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LinearOperator</code></pre><p>A linear operator. Assumes that inputspace and outputspace are defined.  One should also define mul!(y, L::LinearOperator, x) and preallocate_output(L::LinearOperator, x) for efficiency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/SlepianSolver/operators.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.SlepianSolver.compute_eigenfunctions-Union{Tuple{D}, Tuple{AbstractArray{Bool, D}, AbstractArray{Bool, D}}, Tuple{AbstractArray{Bool, D}, AbstractArray{Bool, D}, Any}} where D" href="#SpatialMultitaper.SlepianSolver.compute_eigenfunctions-Union{Tuple{D}, Tuple{AbstractArray{Bool, D}, AbstractArray{Bool, D}}, Tuple{AbstractArray{Bool, D}, AbstractArray{Bool, D}, Any}} where D"><code>SpatialMultitaper.SlepianSolver.compute_eigenfunctions</code></a> ‚Äî <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_eigenfunctions(R::AbstractArray,K::AbstractArray,ntapers=1;imag_tol=1e-5,real_tapers=true, tol=0.0)</code></pre><p>Computes the eigenfunctions of the concentration operator. Provide <code>real_tapers=true</code> for real valued tapers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/SlepianSolver/diagonalisation.jl#L27-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpatialMultitaper.SlepianSolver.make_concentration_operator" href="#SpatialMultitaper.SlepianSolver.make_concentration_operator"><code>SpatialMultitaper.SlepianSolver.make_concentration_operator</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">make_concentration_operator(R::AbstractArray,K::AbstractArray,real_tapers=Val{true}())</code></pre><p>Constructs the concentration operator. Provide <code>real_tapers=Val{true}()</code> for real valued tapers. Choose <code>real_tapers=Val{false}()</code> for complex valued tapers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JakeGrainger/SpatialMultitaper.jl/blob/74febc59065d05385f200dba6c967272f3bd3f74/src/SlepianSolver/diagonalisation.jl#L1-L6">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../91-developer/">¬´ Developer documentation</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 10 July 2025 10:02">Thursday 10 July 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
